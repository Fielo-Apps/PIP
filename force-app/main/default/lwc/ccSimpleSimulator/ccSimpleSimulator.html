<template>

    <lightning-layout class="slds-p-around_x-medium">
        <lightning-layout-item size="7" class="slds-p-horizontal_medium slds-p-top_small">
            <div class="slds-text-heading_large">
                <b>Incentives Calculator</b>
            </div>
        </lightning-layout-item>
        <lightning-layout-item size="5" class="slds-p-horizontal_medium slds-p-top_small">
            <template if:true={hasOutput}>
                <lightning-card >
                    <lightning-layout class="slds-p-around_x-medium" horizontal-align="spread">
                        <template for:each={currencySummary} for:item="currency" for:index="index">
                            <lightning-layout-item key={currency.name} size="3" class="slds-p-horizontal_medium slds-p-top_small">
                                {currency.name}: <br/>
                                Eligible: {currency.amount} <br/>
                                Maximum: {currency.maximum} <br/>
                            </lightning-layout-item>
                        </template>
                    </lightning-layout>
                </lightning-card>
            </template>
        </lightning-layout-item>
    </lightning-layout>
        <template if:true={hasRecords}>
            <div class="slds-var-m-around_medium">
                <template if:true={hasSelectedRecords}>
                    <template if:true={showSimulateButton}>
                        <lightning-button variant="brand" label="Update outcomes" title="Successful action"
                            onclick={handleSimulate} class="slds-m-left_x-small"></lightning-button>
                    </template>
                </template>
                <template if:true={showSelectRecordsButton}>
                    <lightning-button variant="neutral" label="Select Opportunities" title="Successful action"
                        onclick={handleSelectRecords} class="slds-m-left_x-small"></lightning-button>
                </template>
            </div>
            <div class="slds-var-m-around_medium fielo-records-to-simulate" data-step={_selectedStep}>
                <lightning-datatable data={relatedRecords} columns={relatedColumns} key-field="Id"
                    onrowselection={handleSelectedRecord}></lightning-datatable>
            </div>
        </template>

        <template if:true={hasOutput}>
            <div class="slds-var-m-around_medium fielo-simulation-result slds-size_1-of-1">
                <lightning-layout class="slds-p-around_x-medium slds-size_1-of-1" horizontal-align="end">
                    <lightning-layout-item size="1" class="slds-p-horizontal_medium slds-p-top_small slds-p-bottom_medium">
                        <lightning-button-icon-stateful icon-name="utility:summary" selected={isSummaryOutput} onclick={handleSummaryClick} alternative-text="Like"></lightning-button-icon-stateful>
                        <lightning-button-icon-stateful icon-name="utility:table" selected={isTableOutput} onclick={handleTableClick} alternative-text="Answer" class="slds-m-left_xx-small"></lightning-button-icon-stateful>
                    </lightning-layout-item>
                </lightning-layout>

                <template if:true={isTableOutput}>
                    <lightning-datatable class="fielo-output-as-table" data={rows} columns={outputColumns} key-field="Id"></lightning-datatable>
                </template>
                <template if:true={isSummaryOutput}>
                    <lightning-tree-grid class="fielo-output-as-summary" columns={outputColumns} data={summaryRows} expanded-rows={expandedRows} key-field="id"></lightning-tree-grid>
                </template>
            </div>
        </template>

</template>